module MalwareScanning
private

  def malware_scan_result(uploaded_file)
    MalwareScanner.call(
      file_path: uploaded_file.tempfile.path,
      # uploader: provider_uploader,
      file_details: {
        size: uploaded_file_size(uploaded_file),
        name: uploaded_file.original_filename,
        content_type: uploaded_file.content_type,
      },
    )
  end

  def uploaded_file_size(uploaded_file)
    File.size(uploaded_file.tempfile)
  end
end
